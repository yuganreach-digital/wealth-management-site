---
// Navigation component with vertical floating design
const currentPath = Astro.url.pathname;
const basePath = import.meta.env.BASE_URL || '/';
const isHomePage = currentPath === basePath || currentPath === basePath.replace(/\/$/, '') || currentPath === '/';
---

<nav id="navigation" class="fixed left-6 top-1/2 transform -translate-y-1/2 z-50 pointer-events-none opacity-0 translate-x-[-20px] transition-all duration-700 ease-out">
  <!-- Desktop Navigation -->
  <div class="hidden md:block">
    <div class="bg-white/90 backdrop-blur-lg border border-espresso-200/50 rounded-full p-2 space-y-2 pointer-events-auto shadow-xl shadow-espresso-900/10">
      {isHomePage ? (
        <>
          <!-- Home -->
          <a 
            href={basePath} 
            class="relative flex items-center justify-center w-12 h-12 rounded-full text-gold-600 hover:text-gold-700 hover:bg-gold-50 transition-all duration-300 group/item"
            aria-label="Home"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/>
            </svg>
            <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Home</span>
          </a>
          
          <!-- Services -->
          <a 
            href="#services" 
            class="relative flex items-center justify-center w-12 h-12 rounded-full text-gold-600 hover:text-gold-700 hover:bg-gold-50 transition-all duration-300 group/item"
            aria-label="Services"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 00.75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 00-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0112 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 01-.673-.38m0 0A2.18 2.18 0 013 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 013.413-.387m0 0a9.803 9.803 0 0113.5 0"/>
            </svg>
            <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Services</span>
          </a>
          
          <!-- Team -->
          <a 
            href="#team" 
            class="relative flex items-center justify-center w-12 h-12 rounded-full text-gold-600 hover:text-gold-700 hover:bg-gold-50 transition-all duration-300 group/item"
            aria-label="Team"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 3.2 3.2 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/>
            </svg>
            <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Team</span>
          </a>
          
          <!-- Philosophy -->
          <a 
            href="#philosophy" 
            class="relative flex items-center justify-center w-12 h-12 rounded-full text-gold-600 hover:text-gold-700 hover:bg-gold-50 transition-all duration-300 group/item"
            aria-label="Philosophy"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/>
            </svg>
            <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Philosophy</span>
          </a>
          
          <!-- Gallery -->
          <a 
            href="#gallery" 
            class="relative flex items-center justify-center w-12 h-12 rounded-full text-gold-600 hover:text-gold-700 hover:bg-gold-50 transition-all duration-300 group/item"
            aria-label="Gallery"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6.75a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6.75v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"/>
            </svg>
            <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Gallery</span>
          </a>
          
          <!-- Contact -->
          <a 
            href="#contact" 
            class="relative flex items-center justify-center w-12 h-12 rounded-full text-gold-600 hover:text-gold-700 hover:bg-gold-50 transition-all duration-300 group/item"
            aria-label="Contact"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"/>
            </svg>
            <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Contact</span>
          </a>
        </>
      ) : (
        <!-- Back Button (only on non-home pages) -->
        <a 
          href={basePath} 
          class="relative flex items-center justify-center w-12 h-12 rounded-full bg-gold-500 text-espresso-900 hover:bg-gold-400 transition-all duration-300 group/item"
          aria-label="Back to Home"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"/>
          </svg>
          <span class="absolute left-14 bg-black/80 text-white text-sm font-medium px-3 py-1 rounded-lg opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">Back to Home</span>
        </a>
      )}
    </div>
  </div>

  <!-- Mobile Navigation -->
  <div class="md:hidden">
    <div class="bg-white/90 backdrop-blur-lg border border-espresso-200/50 rounded-full p-1 pointer-events-auto shadow-xl shadow-espresso-900/10">
      <button 
        id="mobile-menu-button"
        class="p-2 text-gold-600 hover:text-gold-700 transition-colors duration-300"
        aria-label="Toggle mobile menu"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/>
        </svg>
      </button>
    </div>
  </div>
</nav>

<!-- Mobile Menu Dropdown -->
<div 
  id="mobile-menu"
  class="fixed top-20 left-6 right-6 md:hidden bg-black/30 backdrop-blur-lg border border-white/40 rounded-2xl p-6 hidden z-40"
>
  <div class="space-y-4">
    {isHomePage ? (
      <>
        <a 
          href={basePath} 
          class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gold-400 hover:text-gold-300 hover:bg-white/10 transition-all duration-300"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/>
          </svg>
          <span class="font-medium">Home</span>
        </a>
        
        <a 
          href="#services" 
          class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gold-400 hover:text-gold-300 hover:bg-white/10 transition-all duration-300"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 00.75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 00-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0112 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 01-.673-.38m0 0A2.18 2.18 0 013 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 013.413-.387m0 0a9.803 9.803 0 0113.5 0"/>
          </svg>
          <span class="font-medium">Services</span>
        </a>
        
        <a 
          href="#team" 
          class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gold-400 hover:text-gold-300 hover:bg-white/10 transition-all duration-300"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 3.2 3.2 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/>
          </svg>
          <span class="font-medium">Team</span>
        </a>
        
        <a 
          href="#philosophy" 
          class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gold-400 hover:text-gold-300 hover:bg-white/10 transition-all duration-300"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/>
          </svg>
          <span class="font-medium">Philosophy</span>
        </a>
        
        <a 
          href="#gallery" 
          class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gold-400 hover:text-gold-300 hover:bg-white/10 transition-all duration-300"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6.75a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6.75v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"/>
          </svg>
          <span class="font-medium">Gallery</span>
        </a>
        
        <a 
          href="#contact" 
          class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gold-400 hover:text-gold-300 hover:bg-white/10 transition-all duration-300"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"/>
          </svg>
          <span class="font-medium">Contact</span>
        </a>
      </>
    ) : (
      <!-- Back Button (only on non-home pages) -->
      <a 
        href={basePath} 
        class="flex items-center space-x-3 px-4 py-3 rounded-lg bg-gold-500 text-espresso-900 hover:bg-gold-400 transition-all duration-300"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"/>
        </svg>
        <span class="font-medium">Back to Home</span>
      </a>
    )}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const navigation = document.getElementById('navigation');
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const basePath = import.meta.env.BASE_URL || '/';
    const currentPath = window.location.pathname;
    const isHomePage = currentPath === basePath || currentPath === basePath + '/' || currentPath === '/';

    // Navigation visibility based on scroll position (only on homepage)
    if (isHomePage && navigation) {
      const heroSection = document.getElementById('hero');
      const missionSection = document.getElementById('mission');
      
      if (heroSection && missionSection) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.target.id === 'hero') {
              // Hide navigation when hero is visible
              if (entry.isIntersecting) {
                navigation.style.opacity = '0';
                navigation.style.transform = 'translateY(-50%) translateX(-20px)';
                navigation.style.pointerEvents = 'none';
              }
            } else if (entry.target.id === 'mission') {
              // Show navigation when mission section comes into view
              if (entry.isIntersecting) {
                navigation.style.opacity = '1';
                navigation.style.transform = 'translateY(-50%) translateX(0)';
                navigation.style.pointerEvents = 'auto';
              }
            }
          });
        }, {
          threshold: 0.3,
          rootMargin: '-50px 0px -50px 0px'
        });

        observer.observe(heroSection);
        observer.observe(missionSection);
      }
    } else if (navigation) {
      // On non-homepage, show navigation immediately
      navigation.style.opacity = '1';
      navigation.style.transform = 'translateY(-50%) translateX(0)';
      navigation.style.pointerEvents = 'auto';
    }

    // Mobile menu functionality
    if (mobileMenuButton && mobileMenu) {
      mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
        
        const icon = mobileMenuButton.querySelector('svg');
        if (icon) {
          if (mobileMenu.classList.contains('hidden')) {
            icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/>';
          } else {
            icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12"/>';
          }
        }
      });
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', (e) => {
      if (mobileMenu && !mobileMenuButton?.contains(e.target as Node) && !mobileMenu.contains(e.target as Node)) {
        mobileMenu.classList.add('hidden');
        const icon = mobileMenuButton?.querySelector('svg');
        if (icon) {
          icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/>';
        }
      }
    });

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', (e: Event) => {
        e.preventDefault();
        const href = (anchor as HTMLAnchorElement).getAttribute('href');
        if (href) {
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        }
      });
    });
  });
</script>

<style>
  /* Enhanced vertical floating navigation */
  nav {
    transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Smooth backdrop blur support */
  @supports (backdrop-filter: blur(20px)) {
    nav > div > div {
      backdrop-filter: blur(20px);
    }
  }
  
  /* Subtle glow effect on hover */
  nav > div > div:hover {
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.1);
  }
  
  /* Smooth transitions for all nav elements */
  nav a, nav button {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Mobile menu slide animation */
  #mobile-menu {
    animation: slideDown 0.3s ease-out;
  }
  
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Responsive adjustments */
  @media (max-width: 1023px) {
    nav {
      left: 1rem;
    }
  }
</style>